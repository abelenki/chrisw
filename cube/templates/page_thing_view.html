{% extends "cube_master.html" %}

{% load i18n %}
{% load star %}

{% block html_head %}
	<script type="text/javascript" charset="utf-8" src="/javascript/libs/jquery.raty.min.js"></script>
	<script type="text/javascript" charset="utf-8">
		$(document).ready(
			function(){
				chrisw.raty("#rater", {
					click: function(score, evt){
						var url = "{{thing.url}}/rank?score=" + score + "&result_type=json";
						$.getJSON(url, function(data){
							chrisw.reload()
						})
					}
				});
			}
		);
	</script>
{% endblock %}

{% block content %}
	<h1>
		{{ thing.title }}
	</h1>
	<div>
		<div class="grid_3">
			<img class="imx" src="{{thing.photo_url}}"></img>
		</div>
		<div class="grid_6">
			<ul>
				{% for key, value in thing.fields %}
					<li>
						{{ key }} : {{ value }}
					</li>
				{% endfor %}
			</ul>
		</div>
		<div class="grid_5">
			<div id="rank">
				{% star thing.rank of 5 %} {{thing.rank}}
			</div>
			<table border="0" cellspacing="2" cellpadding="2">
				{% for start_num, rate_count in thing.rank_info.rates %}
					<tr><td style="padding:1px;">
						{% star start_num of 5 small %} 
						</td>
						<td style="padding:1px;padding-left:5px;">
							{{rate_count}}
						</td>
					</tr>

				{% endfor %}
			</table>
			
			{% if can_rank %}
				<div id="rater">
				</div>
			{% endif %}
		</div>
		<div class="clear">
		</div>

		<div class>
			<ul class="buttom">
				{% if can_want %}
					<a class="a_btn a_btn_m" href="{{thing.url}}/want"><span>{% trans "Want" %}</span></a>
				{% endif %}
				{% if can_cancel_want %}
					<a class="a_btn a_btn_m" href="{{thing.url}}/cancel_want"><span>{% trans "Cancel Want" %}</span></a>
				{% endif %}				
				{% if can_own %}
					<a class="a_btn a_btn_m" href="{{thing.url}}/own"><span>{% trans "Own" %}</span></a>
				{% endif %}
				{% if can_cancel_own %}
					<a class="a_btn a_btn_m" href="{{thing.url}}/cancel_own"><span>{% trans "Cancel Own" %}</span></a>
				{% endif %}
			</ul>
		</div>
		<div class="clear"></div>
		
		<div class="grid_15">
			<ul>
				{% for comment in comments %}
					<li>
						{{ comment.content }}
					</li>
				{% endfor %}
			</ul>
		</div>
		<div class="clear">
			
		</div>
		
		<div class="grid_15">
			<ul>
				{% for review in reviews %}
					<li>
						{{ review.content }}
					</li>
				{% endfor %}
			</ul>
		</div>
		<div class="clear">
			
		</div>
	</div>
{% endblock %}